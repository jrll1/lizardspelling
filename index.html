<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chameleon Climb: Spelling Safari</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@400;700&display=swap');
        
        body {
            font-family: 'Lexend', sans-serif;
            background: #061d12;
            overflow: hidden;
            touch-action: manipulation;
        }

        .rainforest-bg {
            background: linear-gradient(to bottom, #1a472a, #0d2b1d);
        }

        .tree-trunk {
            width: 90px;
            background: linear-gradient(90deg, #3d2b1f 0%, #5d4037 50%, #3d2b1f 100%);
            position: relative;
            box-shadow: 20px 0 50px rgba(0,0,0,0.5);
        }

        .tree-trunk::after {
            content: '';
            position: absolute;
            inset: 0;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100' height='100' filter='url(%23noise)' opacity='0.2'/%3E%3C/svg%3E");
            opacity: 0.3;
        }

        .leaf {
            position: absolute;
            background: linear-gradient(135deg, #2e7d32, #1b5e20);
            border-radius: 100% 0 100% 0;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            z-index: 5;
        }

        .lizard {
            transition: all 1.2s cubic-bezier(0.34, 1.56, 0.64, 1);
            filter: drop-shadow(4px 4px 6px rgba(0,0,0,0.5));
            transform-origin: center bottom;
        }

        .dancing {
            animation: dance 0.6s infinite alternate cubic-bezier(0.45, 0, 0.55, 1);
        }

        @keyframes dance {
            0% { transform: translateX(-50%) translateY(0) rotate(-5deg) scale(1.1); }
            100% { transform: translateX(-50%) translateY(-10px) rotate(5deg) scale(1.2); }
        }

        .fart-cloud {
            animation: poof 0.8s ease-out forwards;
            position: absolute;
            pointer-events: none;
            z-index: 40;
        }

        @keyframes poof {
            0% { transform: scale(0.5); opacity: 0; }
            30% { transform: scale(1.2); opacity: 0.8; }
            100% { transform: scale(2); opacity: 0; }
        }

        .keyboard-key {
            user-select: none;
            cursor: pointer;
            transition: all 0.1s;
        }

        .keyboard-key:active {
            transform: scale(0.9) translateY(2px);
            background-color: #10b981;
        }

        .modal-overlay {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
        }

        .chameleon-skin {
            fill: #4ade80;
            transition: fill 0.5s;
        }

        /* Subtle "breathing" effect for the chameleon */
        .lizard-svg {
            animation: breathe 4s ease-in-out infinite;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
    </style>
</head>
<body class="h-screen w-screen flex flex-col md:flex-row items-stretch text-white">

    <!-- Game World -->
    <div class="relative flex-1 rainforest-bg overflow-hidden flex justify-center">
        <!-- The Tree -->
        <div class="tree-trunk h-full">
            <!-- Decorative Leaves -->
            <div class="leaf w-24 h-12 top-10 -left-16 rotate-12"></div>
            <div class="leaf w-28 h-14 top-1/4 -right-20 -rotate-45"></div>
            <div class="leaf w-20 h-10 top-1/2 -left-14 rotate-45"></div>
            <div class="leaf w-32 h-16 top-3/4 -right-24 rotate-12"></div>
            <div class="leaf w-24 h-12 top-[90%] -left-16 -rotate-12"></div>
            
            <!-- Other Animals -->
            <div class="absolute top-[18%] -left-20 text-5xl opacity-90 drop-shadow-lg" title="Parrot">ü¶ú</div>
            <div class="absolute top-[48%] -right-18 text-5xl opacity-90 drop-shadow-lg" title="Monkey">üêí</div>
            <div class="absolute top-[78%] -left-18 text-5xl opacity-90 drop-shadow-lg" title="Snake">üêç</div>

            <!-- The Detailed Chameleon -->
            <div id="lizard" class="lizard absolute left-1/2 -translate-x-1/2 z-20" style="bottom: 60px;">
                <svg class="lizard-svg" width="100" height="80" viewBox="0 0 120 100" xmlns="http://www.w3.org/2000/svg">
                    <!-- Tail (Spiral) -->
                    <path id="tail" d="M85,55 Q115,55 115,75 Q115,95 95,95 Q75,95 75,80 Q75,68 88,68 Q95,68 95,78" fill="none" stroke="#22c55e" stroke-width="10" stroke-linecap="round" />
                    
                    <!-- Back Feet -->
                    <path d="M70,55 L75,75 Q77,80 85,80" fill="none" stroke="#15803d" stroke-width="5" stroke-linecap="round" />
                    
                    <!-- Body (High Arched Back) -->
                    <path class="chameleon-skin" d="M25,60 Q55,10 85,55 L85,65 Q55,75 25,65 Z" stroke="#15803d" stroke-width="2" />
                    
                    <!-- Skin Patterns (Spots) -->
                    <circle cx="45" cy="40" r="3" fill="#22c55e" opacity="0.6" />
                    <circle cx="55" cy="30" r="4" fill="#22c55e" opacity="0.6" />
                    <circle cx="65" cy="35" r="3" fill="#22c55e" opacity="0.6" />

                    <!-- Front Feet -->
                    <path d="M40,65 L35,80 Q33,85 25,85" fill="none" stroke="#15803d" stroke-width="5" stroke-linecap="round" />
                    
                    <!-- Head with Casque (Crest) -->
                    <path class="chameleon-skin" d="M30,62 L5,68 L2,48 L15,30 Q28,25 35,45 Z" stroke="#15803d" stroke-width="2" />
                    
                    <!-- Bulging Turret Eye -->
                    <g transform="translate(18, 52)">
                        <circle r="8" fill="#4ade80" stroke="#15803d" stroke-width="1" />
                        <circle r="3" fill="black" />
                        <circle cx="-1" cy="-1" r="1" fill="white" opacity="0.5" />
                    </g>
                </svg>
            </div>
        </div>

        <!-- Sunlight overlay -->
        <div class="absolute inset-0 bg-gradient-to-t from-transparent via-transparent to-yellow-400/10 pointer-events-none"></div>
    </div>

    <!-- UI Panel -->
    <div class="flex-none w-full md:w-[450px] bg-slate-900 border-t-4 md:border-t-0 md:border-l-4 border-emerald-500 p-6 flex flex-col gap-6 items-center shadow-2xl relative z-30">
        
        <!-- Word Preview Area -->
        <div class="bg-white/5 border border-white/10 rounded-3xl p-6 w-full text-center flex flex-col items-center gap-4 shadow-inner">
            <div id="word-image" class="text-9xl mb-2 filter drop-shadow-2xl animate-pulse">üê±</div>
            <div id="spelling-area" class="flex gap-3 h-16 items-center justify-center">
                <!-- Word slots will be injected here -->
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="w-full bg-slate-800 rounded-full h-5 p-1 border border-white/10 shadow-lg">
            <div id="progress-fill" class="h-full bg-gradient-to-r from-emerald-500 to-yellow-400 rounded-full w-0 transition-all duration-700 ease-out"></div>
        </div>

        <!-- Keyboard Area -->
        <div class="grid grid-cols-7 gap-2 w-full max-w-[400px]">
            <!-- Keys will be generated by JS -->
        </div>

        <div id="feedback-msg" class="h-8 text-yellow-400 font-bold text-2xl tracking-wide transition-all duration-300 opacity-0 transform translate-y-2">
            Perfect!
        </div>
    </div>

    <!-- Win Modal -->
    <div id="win-modal" class="modal-overlay fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="bg-gradient-to-br from-emerald-600 to-emerald-800 p-12 rounded-[3rem] text-center shadow-[0_0_100px_rgba(52,211,153,0.3)] border-4 border-yellow-400 max-w-sm mx-4">
            <div class="text-7xl mb-6 animate-bounce">üëë</div>
            <h2 class="text-5xl font-black mb-4 text-yellow-300 drop-shadow-md">WELL DONE!</h2>
            <p class="text-xl mb-8 font-medium">You reached the top of the tree!</p>
            <button onclick="location.reload()" class="bg-yellow-400 text-slate-900 px-10 py-5 rounded-2xl font-black text-2xl hover:bg-yellow-300 transform transition hover:scale-105 shadow-[0_10px_0_#ca8a04] active:translate-y-1 active:shadow-none">Play Again</button>
        </div>
    </div>

    <script>
        const words = [
            { word: 'cat', icon: 'üê±' },
            { word: 'dog', icon: 'üê∂' },
            { word: 'rat', icon: 'üêÄ' },
            { word: 'bat', icon: 'ü¶á' },
            { word: 'fish', icon: 'üêü' },
            { word: 'frog', icon: 'üê∏' },
            { word: 'pig', icon: 'üê∑' },
            { word: 'log', icon: 'ü™µ' },
            { word: 'bug', icon: 'ü™≤' },
            { word: 'bird', icon: 'üê¶' },
            { word: 'sun', icon: '‚òÄÔ∏è' },
            { word: 'hat', icon: 'üëí' }
        ];

        let currentWordIndex = 0;
        let userInput = "";
        let score = 0;
        const targetScore = 6;
        let shuffledWords = [...words].sort(() => Math.random() - 0.5);

        // Audio Context Setup
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const audioCtx = new AudioContext();

        function playFartSound() {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sawtooth';
            
            // Frequency drop for "realistic" effect
            osc.frequency.setValueAtTime(110, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(30, audioCtx.currentTime + 0.5);
            
            gain.gain.setValueAtTime(0.4, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);

            createFartCloud();
        }

        function playCelebrationMelody() {
            // Simplified "ABC" style melody
            const notes = [
                { f: 261.63, t: 0 }, { f: 261.63, t: 0.25 }, { f: 392.00, t: 0.5 }, 
                { f: 392.00, t: 0.75 }, { f: 440.00, t: 1.0 }, { f: 440.00, t: 1.25 }, 
                { f: 392.00, t: 1.5 }
            ];
            
            notes.forEach(n => {
                const osc = audioCtx.createOscillator();
                const g = audioCtx.createGain();
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(n.f, audioCtx.currentTime + n.t);
                g.gain.setValueAtTime(0, audioCtx.currentTime + n.t);
                g.gain.linearRampToValueAtTime(0.2, audioCtx.currentTime + n.t + 0.05);
                g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + n.t + 0.2);
                osc.connect(g);
                g.connect(audioCtx.destination);
                osc.start(audioCtx.currentTime + n.t);
                osc.stop(audioCtx.currentTime + n.t + 0.25);
            });
        }

        function createFartCloud() {
            const cloud = document.createElement('div');
            cloud.className = 'fart-cloud text-5xl';
            cloud.innerHTML = 'üí®';
            const liz = document.getElementById('lizard');
            const rect = liz.getBoundingClientRect();
            // Position near the tail spiral
            cloud.style.left = `${rect.left + 80}px`;
            cloud.style.top = `${rect.top + 40}px`;
            document.body.appendChild(cloud);
            setTimeout(() => cloud.remove(), 1000);
        }

        function initGame() {
            renderKeyboard();
            loadWord();
        }

        function loadWord() {
            const currentObj = shuffledWords[currentWordIndex];
            userInput = "";
            document.getElementById('word-image').textContent = currentObj.icon;
            const area = document.getElementById('spelling-area');
            area.innerHTML = "";
            
            for (let i = 0; i < currentObj.word.length; i++) {
                const slot = document.createElement('div');
                slot.className = "w-12 h-14 bg-white/10 rounded-xl border-2 border-white/20 text-4xl font-bold flex items-center justify-center text-emerald-300 shadow-lg";
                slot.id = `slot-${i}`;
                area.appendChild(slot);
            }
        }

        function renderKeyboard() {
            const alphabet = "abcdefghijklmnopqrstuvwxyz".split("");
            const container = document.querySelector('.grid');
            container.innerHTML = "";
            alphabet.forEach(letter => {
                const key = document.createElement('div');
                key.className = "keyboard-key bg-slate-800 text-white aspect-square flex items-center justify-center rounded-2xl text-2xl font-bold shadow-[0_4px_0_#1e293b] border border-white/5 active:shadow-none active:translate-y-1";
                key.textContent = letter;
                key.onclick = () => handleInput(letter);
                container.appendChild(key);
            });

            const back = document.createElement('div');
            back.className = "keyboard-key bg-red-600/80 text-white col-span-2 flex items-center justify-center rounded-2xl text-lg font-black uppercase shadow-[0_4px_0_#7f1d1d] active:shadow-none active:translate-y-1";
            back.textContent = "clear";
            back.onclick = () => { userInput = ""; updateSlots(); };
            container.appendChild(back);
        }

        function handleInput(letter) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const target = shuffledWords[currentWordIndex].word;
            if (userInput.length < target.length) {
                userInput += letter;
                updateSlots();

                if (userInput.length === target.length) {
                    setTimeout(checkAnswer, 200);
                }
            }
        }

        function updateSlots() {
            const target = shuffledWords[currentWordIndex].word;
            for (let i = 0; i < target.length; i++) {
                const slot = document.getElementById(`slot-${i}`);
                if (slot) slot.textContent = userInput[i] || "";
            }
        }

        function checkAnswer() {
            const target = shuffledWords[currentWordIndex].word;
            if (userInput === target) {
                onCorrect();
            } else {
                onWrong();
            }
        }

        function onCorrect() {
            score++;
            const liz = document.getElementById('lizard');
            const progress = document.getElementById('progress-fill');
            const feedback = document.getElementById('feedback-msg');

            feedback.textContent = "Super Spelling!";
            feedback.classList.remove('translate-y-2');
            feedback.style.opacity = 1;
            
            // Visual chameleon response
            const paths = liz.querySelectorAll('.chameleon-skin');
            paths.forEach(p => p.style.fill = '#facc15'); // Turns yellow when happy
            
            setTimeout(() => {
                feedback.style.opacity = 0;
                feedback.classList.add('translate-y-2');
                paths.forEach(p => p.style.fill = ''); // Turns back to green
            }, 2500);

            playCelebrationMelody();
            liz.classList.add('dancing');
            setTimeout(() => liz.classList.remove('dancing'), 7000);

            // Move Lizard up the tree
            const treeHeight = document.querySelector('.tree-trunk').offsetHeight;
            const climbStep = (treeHeight - 180) / targetScore;
            liz.style.bottom = `${60 + (score * climbStep)}px`;
            
            progress.style.width = `${(score / targetScore) * 100}%`;

            if (score >= targetScore) {
                setTimeout(() => {
                    document.getElementById('win-modal').classList.remove('hidden');
                }, 3000);
            } else {
                currentWordIndex++;
                if (currentWordIndex >= shuffledWords.length) {
                    currentWordIndex = 0;
                    shuffledWords.sort(() => Math.random() - 0.5);
                }
                setTimeout(loadWord, 1500);
            }
        }

        function onWrong() {
            playFartSound();
            userInput = "";
            const feedback = document.getElementById('feedback-msg');
            feedback.textContent = "Try again!";
            feedback.classList.add('text-red-400');
            feedback.classList.remove('translate-y-2');
            feedback.style.opacity = 1;
            
            const area = document.getElementById('spelling-area');
            area.classList.add('animate-ping');
            
            setTimeout(() => {
                feedback.style.opacity = 0;
                feedback.classList.add('translate-y-2');
                feedback.classList.remove('text-red-400');
                area.classList.remove('animate-ping');
                updateSlots();
            }, 1000);
        }

        window.onload = initGame;
    </script>
</body>
</html>
